/* ============================================================================
   ROOT CONTAINER
   ============================================================================ */
/* ROOT: Full screen overlay BEHIND the chat */
.stne--root {
  position: fixed !important;
  inset: 0;
  width: 100vw !important;
  height: 100vh !important;
  z-index: 10; /* Lower than #sheld (30) - stays behind main UI */
  pointer-events: none; /* Allows clicking through to the app */
  background: transparent;
  display: block;
  /* Pulse magnitude when a name/alias is re-mentioned during streaming.
     Adjust this value to control scale intensity (1.0 = no pulse, 1.15 = strong). */
  --ne-pulse-scale: 1.08;
}

/* ============================================================================
   WRAPPERS & IMAGES - Base Styles
   ============================================================================ */
/* WRAPPERS: Common logic for all images */
.stne--wrapper {
  position: absolute !important;
  height: 50vh !important; /* Forces each image to be half the screen height */
  width: auto !important;  /* Width scales naturally based on aspect ratio */
  margin: 0 !important;
  padding: 0 !important;

  /* Reset dynamic animation styles */
  transform: none !important;
  scale: 1 !important;
  top: auto; bottom: auto; left: auto; right: auto;

  /* Smooth transitions for movement */
  transition: opacity 0.3s ease, transform 0.3s ease;
}

/* IMAGE: Ensure it fills the wrapper with visual polish */
.stne--img {
  height: 100% !important;
  width: auto !important;
  object-fit: contain;
  display: block;
  cursor: pointer;
  pointer-events: all;
  transition: opacity 0.2s ease, filter 0.2s ease, transform 0.2s ease;

  /* Subtle shadow for depth - similar to modal */
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
}

/* Hover effect for images - subtle zoom and enhanced shadow */
.stne--img:hover {
  opacity: 0.95;
  filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.4));
  transform: scale(1.02);
}

/* Active speaker indicator - enhanced glow effect */
.stne--wrapper.stne--last .stne--img {
  filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.4))
          drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
  animation: subtle-pulse 2s ease-in-out infinite;
}

@keyframes subtle-pulse {
  0%, 100% {
    filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.4))
            drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
  }
  50% {
    filter: drop-shadow(0 0 30px rgba(255, 255, 255, 0.6))
            drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3));
  }
}

/* Exit animation */
.stne--wrapper.stne--exit {
  opacity: 0;
  transform: scale(0.95);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

/* Hidden state */
.stne--wrapper.stne--hidden {
  opacity: 0;
  pointer-events: none;
}

/* ============================================================================
   CORNER POSITIONS - Slot Ordering
   ============================================================================ */
/* Image 1: Top Left */
.stne--wrapper[style*="--order: 0"],
.stne--wrapper[style*="--order:0"] {
  top: 0;
  left: 0;
  transform-origin: top left;
}

/* Image 2: Bottom Left */
.stne--wrapper[style*="--order: 1"],
.stne--wrapper[style*="--order:1"] {
  bottom: 0;
  left: 0;
  transform-origin: bottom left;
}

/* Image 3: Top Right */
.stne--wrapper[style*="--order: 2"],
.stne--wrapper[style*="--order:2"] {
  top: 0;
  right: 0;
  transform-origin: top right;
}

/* Image 4: Bottom Right */
.stne--wrapper[style*="--order: 3"],
.stne--wrapper[style*="--order:3"] {
  bottom: 0;
  right: 0;
  transform-origin: bottom right;
}

/* Hide any extra images (Order 4+) */
.stne--wrapper[style*="--order: 4"],
.stne--wrapper[style*="--order: 5"] {
  display: none;
}

/* ============================================================================
   VISIBLE COUNT LAYOUTS - Adaptive positioning based on character count
   ============================================================================ */
/* 1 image: use full height on the left for slot 0 */
.stne--root[data-visible-count="1"] .stne--wrapper[style*="--order: 0"],
.stne--root[data-visible-count="1"] .stne--wrapper[style*="--order:0"] {
  height: 100vh !important;
  top: 0 !important;
  bottom: 0 !important;
  left: 0 !important;
  right: auto !important;
  transform-origin: center left;
}

/* 2 images: slot 0 full-left, slot 1 full-right */
.stne--root[data-visible-count="2"] .stne--wrapper[style*="--order: 0"],
.stne--root[data-visible-count="2"] .stne--wrapper[style*="--order:0"] {
  height: 100vh !important;
  top: 0 !important;
  bottom: 0 !important;
  left: 0 !important;
  right: auto !important;
  transform-origin: center left;
}
.stne--root[data-visible-count="2"] .stne--wrapper[style*="--order: 1"],
.stne--root[data-visible-count="2"] .stne--wrapper[style*="--order:1"] {
  height: 100vh !important;
  top: 0 !important;
  bottom: 0 !important;
  right: 0 !important;
  left: auto !important;
  transform-origin: center right;
}

/* 3 images: slot 0 full-left; slots 1 and 2 are half-height on the right (top and bottom) */
.stne--root[data-visible-count="3"] .stne--wrapper[style*="--order: 0"],
.stne--root[data-visible-count="3"] .stne--wrapper[style*="--order:0"] {
  height: 100vh !important;
  top: 0 !important;
  bottom: 0 !important;
  left: 0 !important;
  right: auto !important;
  transform-origin: center left;
}
/* place order:1 at top-right half */
.stne--root[data-visible-count="3"] .stne--wrapper[style*="--order: 1"],
.stne--root[data-visible-count="3"] .stne--wrapper[style*="--order:1"] {
  height: 50vh !important;
  top: 0 !important;
  right: 0 !important;
  bottom: auto !important;
  left: auto !important;
  transform-origin: top right;
}
/* place order:2 at bottom-right half */
.stne--root[data-visible-count="3"] .stne--wrapper[style*="--order: 2"],
.stne--root[data-visible-count="3"] .stne--wrapper[style*="--order:2"] {
  height: 50vh !important;
  bottom: 0 !important;
  right: 0 !important;
  top: auto !important;
  left: auto !important;
  transform-origin: bottom right;
}

/* ============================================================================
   AREA CONTAINERS - Left/Right side panels
   ============================================================================ */
.stne--area {
  position: absolute;
  top: 0;
  bottom: 0;
  pointer-events: none;
  overflow: visible; /* allow wrappers/images to overflow the area */
  z-index: inherit; /* keep stacking consistent with .stne--root */
}

/* Left and right anchors use the inline CSS variables provided by index.js */
.stne--left-area {
  left: 0;
  width: var(--left-space, 0px);
}
.stne--right-area {
  right: 0;
  width: var(--right-space, 0px);
}

/* ============================================================================
   PLACEMENT MODE: CENTER - Images centered in side areas
   ============================================================================ */
/* CENTER mode: For visible counts 1 and 2 we want full-height wrappers centered inside each side-area */
.stne--root[data-placement-mode="center"][data-visible-count="1"] .stne--area .stne--wrapper,
.stne--root[data-placement-mode="center"][data-visible-count="2"] .stne--area .stne--wrapper {
  height: 100vh !important;
  top: 0 !important;
  bottom: 0 !important;
  left: 50% !important; /* center inside the area */
  right: auto !important;
  transform: translateX(-50%) !important; /* horizontally center */
  width: auto !important; /* keep width determined by aspect ratio */
}

.stne--root[data-placement-mode="center"][data-visible-count="1"] .stne--area .stne--img,
.stne--root[data-placement-mode="center"][data-visible-count="2"] .stne--area .stne--img {
  height: 100% !important;
  width: auto !important;
  object-fit: contain;
}

/* CENTER: horizontally center wrappers for visible counts 3 and 4 without changing heights */
.stne--root[data-placement-mode="center"][data-visible-count="3"] .stne--area .stne--wrapper,
.stne--root[data-placement-mode="center"][data-visible-count="4"] .stne--area .stne--wrapper {
  left: 50% !important;
  transform: translateX(-50%) !important;
}

/* Force true centering for wrappers with --order attribute (higher specificity override) */
.stne--root[data-placement-mode="center"] .stne--area .stne--wrapper[style*="--order:"] {
  left: 50% !important;
  right: auto !important;
  transform: translateX(-50%) !important;
  transform-origin: center center !important;
}

/* Ensure images inside centered wrappers use full-height when applicable */
.stne--root[data-placement-mode="center"][data-visible-count="1"] .stne--area .stne--wrapper[style*="--order:"] .stne--img,
.stne--root[data-placement-mode="center"][data-visible-count="2"] .stne--area .stne--wrapper[style*="--order:"] .stne--img {
  height: 100% !important;
  width: auto !important;
  object-fit: contain !important;
}

/* CENTER-mode: 1px visual gap between stacked half-height wrappers */
.stne--root[data-placement-mode="center"][data-visible-count="3"] .stne--area .stne--wrapper[style*="--order: 1"],
.stne--root[data-placement-mode="center"][data-visible-count="3"] .stne--area .stne--wrapper[style*="--order:1"],
.stne--root[data-placement-mode="center"][data-visible-count="3"] .stne--area .stne--wrapper[style*="--order: 2"],
.stne--root[data-placement-mode="center"][data-visible-count="3"] .stne--area .stne--wrapper[style*="--order:2"] {
  height: calc(50vh - 0.5px) !important;
}

.stne--root[data-placement-mode="center"][data-visible-count="4"] .stne--area .stne--wrapper[style*="--order: 0"],
.stne--root[data-placement-mode="center"][data-visible-count="4"] .stne--area .stne--wrapper[style*="--order:0"],
.stne--root[data-placement-mode="center"][data-visible-count="4"] .stne--area .stne--wrapper[style*="--order: 1"],
.stne--root[data-placement-mode="center"][data-visible-count="4"] .stne--area .stne--wrapper[style*="--order:1"],
.stne--root[data-placement-mode="center"][data-visible-count="4"] .stne--area .stne--wrapper[style*="--order: 2"],
.stne--root[data-placement-mode="center"][data-visible-count="4"] .stne--area .stne--wrapper[style*="--order:2"],
.stne--root[data-placement-mode="center"][data-visible-count="4"] .stne--area .stne--wrapper[style*="--order: 3"],
.stne--root[data-placement-mode="center"][data-visible-count="4"] .stne--area .stne--wrapper[style*="--order:3"] {
  height: calc(50vh - 0.5px) !important;
}

/* ============================================================================
   PLACEMENT MODE: WIDTH - Images fill available width
   ============================================================================ */
/* WIDTH mode: Use flexbox to stack multiple wrappers vertically */
.stne--root[data-placement-mode="width"] .stne--area {
  display: flex !important;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1px !important;
  min-height: 0;
}

/* Wrappers in WIDTH mode */
.stne--root[data-placement-mode="width"] .stne--area .stne--wrapper {
  position: relative !important;
  top: auto !important;
  bottom: auto !important;
  left: auto !important;
  right: auto !important;
  transform: none !important;
  transform-origin: center center !important;
  width: auto !important;
  height: auto !important;
  margin: 0 !important;
  flex: 1 1 0 !important;
  max-height: 100% !important;
  box-sizing: border-box;
  min-height: 0;
}

/* Single wrapper in WIDTH mode fills width */
.stne--root[data-placement-mode="width"] .stne--area .stne--wrapper:only-child {
  width: 100% !important;
  flex: 0 1 auto !important;
}

/* Images in WIDTH mode with multiple wrappers */
.stne--root[data-placement-mode="width"] .stne--area .stne--wrapper:not(:only-child) .stne--img {
  height: 100% !important;
  width: auto !important;
  max-width: 100% !important;
  object-fit: contain;
}

/* Images in WIDTH mode with single wrapper */
.stne--root[data-placement-mode="width"] .stne--area .stne--wrapper:only-child .stne--img {
  width: 100% !important;
  height: auto !important;
  max-height: 100% !important;
  object-fit: contain;
}

/* Center multiple wrappers horizontally */
.stne--root[data-placement-mode="width"] .stne--area .stne--wrapper + .stne--wrapper {
  align-self: center;
}

/* ============================================================================
   MODAL OVERLAY - Zoomed image view
   ============================================================================ */
.stne--modal-overlay {
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100vh;
  z-index: 1000; /* High z-index to appear above everything */
  background: rgba(0, 0, 0, 0.95); /* Slightly darker background */
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: all;
  opacity: 0;
  transition: opacity 0.3s ease;
  backdrop-filter: blur(4px); /* Subtle blur effect on background */
}

.stne--modal-img {
  max-width: 95vw;
  max-height: 95vh;
  object-fit: contain;
  cursor: pointer;
  animation: stne-zoom-in 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  filter: drop-shadow(0 10px 40px rgba(0, 0, 0, 0.5));
}

@keyframes stne-zoom-in {
  from {
    transform: scale(0.85);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

/* ============================================================================
   NAME PULSE - Triggered when a name/alias gets an additional mention during streaming
   ============================================================================ */
@keyframes stne-name-pulse {
  0%, 100% { scale: 1; }
  50% { scale: var(--ne-pulse-scale, 1.08); }
}

.stne--name-pulse .stne--img {
  animation: stne-name-pulse 0.4s ease-in-out;
}
